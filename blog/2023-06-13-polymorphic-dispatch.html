<head><title>Greg Jensen's Blog</title><link href="/styles.css" rel="stylesheet" type="text/css" /></head><body><div class="center"><a href="/">Home</a><a href="/math.html">Math</a><a href="/contact.html">Contact</a><a href="/blog">Blog</a><a href="https://www.github.com/g-jensen">GitHub</a></div><div class="post"><div><h1>Polymorphic Dispatch</h1><p>2023-06-13</p><!---
Tags:
[:clojure]
--><p>Polymorphic dispath is a way to call a function in a different way based on polymorphism. As an example, in my tictactoe game I have different game-modes: one for playing versus a player (<code>PvPGame</code>) and one for playing versus a computer (<code>PvCGame</code>). For all game-modes I want a <code>next-board</code> function to get the board with the next move played whether it may be from the user or from the the calculations of a computer. To do this, I made an interface (or protocol in Clojure) that houses a <code>next-board</code> function but does not implement it. Then, I created two the types PvPGame and PvCGame which inherit from GameMode and implemented <code>next-board</code> to my liking in both. This way in my main loop I can just call <code>next-board</code> regardless of the game-mode and polymorphic dispatch will make sure the right version of <code>next-board</code> is called.</p><p>My Clojure code for the protocol and types looks something like:</p><pre><code class="language-clojure">(defprotocol GameMode
  (initial-board [this])
  (next-board [this board]))

(defrecord PvPGame []
  GameMode
  (next-board [this board]
    (play-move board (get-user-move))))

(defrecord PvCGame [player-character]
  GameMode
  (next-board [this board]
    (if (= player-character (player-to-move board))
      (play-move board (get-user-move))
      (play-move board (get-computer-move board)))))
</code></pre></div></div></body>